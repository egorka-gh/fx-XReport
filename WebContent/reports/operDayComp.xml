<element-set>
  <element name="rpbody">
    <sql>
      <![CDATA[    
SELECT
  CONCAT_WS(' ','Выручка кассы №', pos.kkm_number) kkm,
  :pkasir kasir,
  CONCAT_WS(' ',CAST(pos.number AS CHAR),DATE_FORMAT(mo.date,'%H-%i')) term,
  mo.date AS shiftdate,
  login.user_name AS cashiername,
  mo.date operday,
  mo.amount AS sum,
  xrep.num_to_text(mo.amount) spellsum
FROM ukmserver.trm_out_moneyoperation mo
  INNER JOIN ukmserver.trm_out_login login ON login.cash_id = mo.cash_id AND login.id = mo.login
  INNER JOIN ukmserver.trm_in_pos pos ON pos.cash_id = mo.cash_id
WHERE mo.date>= STR_TO_DATE( :pdate , '%Y-%m-%d') AND mo.date<DATE_ADD(STR_TO_DATE( :pdate , '%Y-%m-%d'),INTERVAL 1 DAY) AND pos.store_id=:pstore
ORDER BY pos.number,mo.date
	]]>
    </sql>
  </element>
  <element name="rptotal">
    <sql>
      <![CDATA[    
SELECT pos.number term, DATE_FORMAT(mo.date, '%Y-%m-%d') shiftdate, SUM(mo.amount) total
FROM ukmserver.trm_out_moneyoperation mo
  INNER JOIN ukmserver.trm_in_pos pos ON pos.cash_id = mo.cash_id
WHERE mo.date >= STR_TO_DATE( :pdate , '%Y-%m-%d') AND mo.date < DATE_ADD(STR_TO_DATE( :pdate , '%Y-%m-%d'), INTERVAL 1 DAY) AND pos.store_id = :pstore
GROUP BY pos.number,DATE_FORMAT(mo.date, '%Y-%m-%d')
	]]>
    </sql>
  </element>

</element-set>
